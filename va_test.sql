-- Auto-generated Arrow view DDL
-- Entity: User
-- View: va_test
-- Type: Vector Arrow (va_)
-- Refresh strategy: trigger-based
-- Generated by: fraiseql generate-views

DROP VIEW IF EXISTS va_test CASCADE;

CREATE VIEW va_test AS
SELECT
    id,
    -- User entity fields
    created_at,
    updated_at
FROM public.schema_placeholder
WHERE archived_at IS NULL;

-- Composition views
CREATE VIEW test_recent AS
SELECT * FROM {}
WHERE updated_at > NOW() - INTERVAL '7 days'
ORDER BY updated_at DESC;

CREATE VIEW test_count AS
SELECT COUNT(*) as total FROM {};

-- Monitoring functions
CREATE OR REPLACE FUNCTION monitor_va_test()
RETURNS TABLE (
    metric_name TEXT,
    metric_value BIGINT
) AS $$
BEGIN
    RETURN QUERY
    SELECT 'row_count'::TEXT, COUNT(*)::BIGINT FROM va_test;
END;
$$ LANGUAGE plpgsql IMMUTABLE;
