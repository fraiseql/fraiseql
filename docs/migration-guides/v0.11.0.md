# Migration Guide: v0.10.x → v0.11.0

## Overview

v0.11.0 removes the PostgreSQL CamelForge function dependency in favor of pure Rust transformation.

## Breaking Changes

### 1. Configuration Changes

**Remove these parameters from `FraiseQLConfig`:**
- `camelforge_function` ❌
- `camelforge_field_threshold` ❌

**Keep this parameter:**
- `jsonb_field_limit_threshold` ✅ (unchanged behavior)

### 2. SQL Generator Changes

If you call `build_sql_query()` directly, remove these parameters:
- `camelforge_enabled` ❌
- `camelforge_function` ❌
- `entity_type` ❌

### 3. Database Function (Optional Cleanup)

The PostgreSQL CamelForge function is no longer used. You can safely drop it:

```sql
-- Optional cleanup (not required)
DROP FUNCTION IF EXISTS turbo.fn_camelforge(jsonb, text);
```

## Migration Steps

### Step 1: Update Configuration

```python
# Before (v0.10.x)
config = FraiseQLConfig(
    database_url="postgresql://localhost/db",
    camelforge_function="turbo.fn_camelforge",  # Remove this
    camelforge_field_threshold=20,              # Remove this
    jsonb_field_limit_threshold=20,
)

# After (v0.11.0+)
config = FraiseQLConfig(
    database_url="postgresql://localhost/db",
    jsonb_field_limit_threshold=20,
)
```

### Step 2: Update Direct SQL Generator Calls

```python
# Before (v0.10.x)
query = build_sql_query(
    table="v_users",
    field_paths=field_paths,
    camelforge_enabled=True,              # Remove this
    camelforge_function="turbo.fn_camelforge",  # Remove this
    entity_type="user",                   # Remove this
)

# After (v0.11.0+)
query = build_sql_query(
    table="v_users",
    field_paths=field_paths,
    # Rust handles transformation automatically
)
```

### Step 3: Test Your Application

Run your test suite to ensure everything works:

```bash
pytest
```

## No Action Required For

- Standard FraiseQL usage (decorators, resolvers)
- GraphQL queries and mutations
- JSONB extraction behavior
- Performance characteristics (still 10-80x faster)

## Benefits

- ✅ Simpler configuration
- ✅ No database function dependency
- ✅ Easier deployment
- ✅ Same exceptional performance

## Additional Configuration Flags Removed

v0.11.0 also removes several performance configuration flags that are now always enabled:

### Removed Flags (Always Enabled)

- `json_passthrough_enabled` / `json_passthrough_in_production` / `json_passthrough_cache_nested`
- `pure_json_passthrough` - Now **always enabled** (25-60x faster queries)
- `pure_passthrough_use_rust` - Now **always enabled** (10-80x faster JSON transformation)
- `enable_query_caching` / `enable_turbo_router` - Now **always enabled**
- `jsonb_extraction_enabled` / `jsonb_auto_detect` / `jsonb_default_columns` - Now **always enabled**
- `unified_executor_enabled` / `turbo_enable_adaptive_caching` - Now **always enabled**
- `passthrough_auto_detect_views` / `passthrough_cache_view_metadata` - Now **always enabled**
- `enable_mode_hints` - Now **always enabled**

Simply remove these flags from your `FraiseQLConfig` - they're no longer needed.

## Troubleshooting

### Error: `AttributeError: 'FraiseQLConfig' object has no attribute 'camelforge_function'`

**Solution**: You're trying to use v0.10.x configuration with v0.11.0. Remove the `camelforge_function` and `camelforge_field_threshold` parameters from your config.

### Error: `TypeError: build_sql_query() got an unexpected keyword argument 'camelforge_enabled'`

**Solution**: You're passing v0.10.x parameters to `build_sql_query()`. Remove `camelforge_enabled`, `camelforge_function`, and `entity_type` parameters.

## Performance Impact

**No performance changes** - v0.11.0 maintains the same 10-80x faster camelCase transformation as v0.10.x. The only difference is that Rust handles all transformation instead of PostgreSQL.

## Need Help?

- GitHub Issues: https://github.com/fraiseql/fraiseql/issues
- Discussions: https://github.com/fraiseql/fraiseql/discussions

## See Also

- [Configuration Guide](../core/configuration.md)
- [CHANGELOG](../../CHANGELOG.md)
- [GitHub Release v0.11.0](https://github.com/fraiseql/fraiseql/releases/tag/v0.11.0)
