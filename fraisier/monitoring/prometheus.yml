"""Prometheus configuration for Fraisier deployment orchestrator.

Collects metrics from:
- Fraisier application (port 8001)
- PostgreSQL (via postgres_exporter)
- System metrics (via node_exporter)

Retention: 15 days
Scrape interval: 15 seconds
Evaluation interval: 15 seconds
"""

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: fraisier-monitor

# Alerting configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets: []

# Load rules files
rule_files:
  - /etc/prometheus/alert-rules.yml

scrape_configs:
  # ============================================================================
  # Fraisier Application Metrics
  # ============================================================================
  - job_name: fraisier
    static_configs:
      - targets:
          - fraisier:8001
    metrics_path: /metrics
    scrape_interval: 15s
    scrape_timeout: 10s

  # ============================================================================
  # PostgreSQL Metrics (via postgres_exporter)
  # ============================================================================
  # Note: Requires postgres_exporter service to be running
  # Uncomment when postgres_exporter is added to docker-compose
  # - job_name: postgres
  #   static_configs:
  #     - targets:
  #         - postgres_exporter:9187
  #   scrape_interval: 30s
  #   scrape_timeout: 10s

  # ============================================================================
  # Prometheus Self-Monitoring
  # ============================================================================
  - job_name: prometheus
    static_configs:
      - targets:
          - localhost:9090
