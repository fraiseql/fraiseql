[package]
name = "fraiseql-core"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
license.workspace = true
repository.workspace = true
homepage.workspace = true
documentation.workspace = true
keywords.workspace = true
categories.workspace = true
description = "Core execution engine for FraiseQL v2 - Compiled GraphQL over SQL"
readme = "README.md"

[dependencies]
# Workspace dependencies
serde = { workspace = true }
serde_json = { workspace = true }
thiserror = { workspace = true }
anyhow = { workspace = true }
tokio = { workspace = true }
async-trait.workspace = true
futures = { workspace = true }

# Database - PostgreSQL
tokio-postgres = { workspace = true, features = ["with-serde_json-1"] }
deadpool-postgres.workspace = true
postgres-native-tls = { workspace = true }
native-tls = { workspace = true }
deadpool = { workspace = true }

# Database - MySQL/SQLite (via sqlx)
sqlx = { version = "0.8", features = ["runtime-tokio", "json"], optional = true }

# Database - SQL Server
tiberius = { version = "0.12", default-features = false, features = ["tds73", "rustls"], optional = true }
bb8 = { version = "0.8", optional = true }
bb8-tiberius = { version = "0.15", optional = true }

# fraiseql-wire backend (optional)
fraiseql-wire = { path = "../../../fraiseql-wire", optional = true }

# GraphQL
graphql-parser = { workspace = true }

# Utilities
bytes = { workspace = true }
regex = { workspace = true }
lazy_static = { workspace = true }
once_cell = { workspace = true }
itertools = { workspace = true }
lru = { workspace = true }
linked-hash-map = { workspace = true }
sha2 = { workspace = true }
hex = { workspace = true }
jsonwebtoken = { workspace = true }
chrono = { workspace = true }
uuid = { workspace = true }
rand = { workspace = true }
reqwest = { workspace = true }
toml = { workspace = true }
parking_lot = { workspace = true }
dashmap = { workspace = true }

# Logging
tracing = { workspace = true }

[dev-dependencies]
tokio-test = "0.4"
criterion = { version = "0.5", features = ["async_tokio"] }

[features]
default = ["postgres"]
postgres = []
mysql = ["sqlx/mysql"]
sqlite = ["sqlx/sqlite"]
sqlserver = ["tiberius", "bb8", "bb8-tiberius"]
wire-backend = ["fraiseql-wire"]

# Benchmarks will be added in later phases
# [[bench]]
# name = "schema_benchmark"
# harness = false
#
# [[bench]]
# name = "cache_benchmark"
# harness = false


[[bench]]
name = "database_baseline"
harness = false

[[bench]]
name = "adapter_comparison"
harness = false
required-features = ["postgres"]

[[bench]]
name = "full_pipeline_comparison"
harness = false
required-features = ["postgres"]

[[bench]]
name = "sql_projection_benchmark"
harness = false

